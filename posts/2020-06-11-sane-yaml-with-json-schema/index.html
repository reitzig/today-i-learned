<!doctype html><html lang=en><meta charset=utf-8><meta name=generator content="Hugo 0.78.1"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=color-scheme content="light dark"><meta name=supported-color-schemes content="light dark"><title>Sane YAML With JSON Schema&nbsp;&ndash;&nbsp;Today I Learned</title><link rel=stylesheet href=/today-i-learned/css/core.min.26e6d94f4c8a8ad1f2700ad4e269c6f9651f8beb5e5f8be05d5dc6e12a76c968585cde9fc585afee9a5be325c54837da.css integrity=sha384-JubZT0yKitHycArU4mnG+WUfi+teX4vgXV3G4Sp2yWhYXN6fxYWv7ppb4yXFSDfa><meta name=twitter:card content="summary"><meta name=twitter:title content="Sane YAML With JSON Schema"><base href=https://reitzig.github.io/today-i-learned/><link rel=icon href="data:;base64,="><meta name=author content="Raphael Reitzig"><meta name=description content="Most popular CI/CD systems use YAML as input language for their pipelines.
Debugging pipelines is always annoying due to long feedback cycles,
but I get particularly upset if the reason for failure is malformed YAML.







How do I stay sane?"><meta name=keywords content="Tool,JSON Schema,Intellij IDEA,Programming"><body><section id=header><div class="header wrap"><span class="header left-side"><a class="site home" href=/today-i-learned/><span class="site name">Today I Learned</span></a></span>
<span class="header right-side"><div class="nav wrap"><nav class=nav><a class="nav item" href=/today-i-learned/tags/>Tags</a><a class="nav item" href=impressum>About</a></nav></div></span></div></section><section id=content><div class=article-container><section class="article header"><h1 class="article title">Sane YAML With JSON Schema</h1><p class="article date">2020-06-11</p><p class="article github_edit"><a rel=nofollow href=https://github.com/reitzig/today-i-learned/edit/master/content/posts/2020-06-11-sane-yaml-with-json-schema.adoc></a></p><p class="article tweet_link"><a href=https://twitter.com/OmegaPolice/status/1271198064951386118><span class="iconfont icon-twitter"></span></a></p></section><article class="article markdown-body"><div class=paragraph><p>Most popular CI/CD systems use YAML as input language for their pipelines.
Debugging pipelines is always annoying due to long feedback cycles,
but I get particularly upset if the reason for failure is malformed YAML.</p></div><div class=imageblock><div class=content><img src=img/2020-06-11-json-schema-for-yaml-0.png alt="GitHub Actions syntax error"></div></div><div class=paragraph><p>How do I stay sane?</p></div><div class=paragraph><p>Lucky for me, there is
<a href=https://json-schema.org/>JSON Schema</a>.
More to the point,</p></div><div class=ulist><ul><li><p>there are
<a href=https://www.schemastore.org/json/>schemas for many popular interfaces</a>,</p></li><li><p>they apply to YAML without changes, and</p></li><li><p>Jetbrains built
<a href=https://www.jetbrains.com/help/idea/json.html#>first-level support</a>
into their IDEs.</p></li></ul></div><div class=paragraph><p>Here is what that looks like for
<a href=https://help.github.com/en/actions/reference/workflow-syntax-for-github-actions>GitHub Actions workflows</a>
as just one example.</p></div><div class="olist arabic"><ol class=arabic><li><p>Open your Most Painful YAML and notice a small, innocuous label at the bottom:</p><div class=imageblock><div class=content><img src=img/2020-06-11-json-schema-for-yaml-1.png alt="GitHub Actions syntax error"></div></div><div class=paragraph><p>It is <em>actually</em> a button — click it!</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content>If you don't see this, <a href=img/2020-06-11-json-schema-for-yaml-6.png>check your settings</a>.</td></tr></tbody></table></div></li><li><p>Start typing the type of thing at hand and see if a schema is available:</p><div class=imageblock><div class=content><img src=img/2020-06-11-json-schema-for-yaml-2.png alt="GitHub Actions syntax error"></div></div></li><li><p>Visit the Schema Mappings dialog to add custom schemas and
fine-tune your configuration:</p><div class=imageblock><div class=content><img src=img/2020-06-11-json-schema-for-yaml-3.png alt="GitHub Actions syntax error" width=90%></div></div><div class=paragraph><p>Note how I told IDEA to match all files in <code>.github/workflows</code> to the appropriate schema.</p></div></li></ol></div><div class=paragraph><p>While by no means perfect — especially if the published schema does not quite match what you need,
or is written badly — there are some immediate benefits. Wrong indentation after copy-pasting?
Highlighted:</p></div><div class=imageblock><div class=content><img src=img/2020-06-11-json-schema-for-yaml-4.png alt="GitHub Actions syntax error"></div></div><div class=paragraph><p>Not the most obvious error message — thanks, everything-goes YAML syntax! — but at least we know something is wrong!
We even get syntax completion and,
if the schema contains it,
inline documentation:</p></div><div class=imageblock><div class=content><img src=img/2020-06-11-json-schema-for-yaml-5.png alt="GitHub Actions syntax error"></div></div><div class=paragraph><p>Very cool!
If anyone ever asks me why they should create schemas for their interface,
this here is one very concrete value I will point to.</p></div><div class="admonitionblock caution"><table><tbody><tr><td class=icon><i class="fa icon-caution" title=Caution></i></td><td class=content>In case you hadn't noticed:
I do <em>not</em> like YAML. It is a time-sink without end.
Whoever decided that whitespace should be part of any formal syntax needs to be …​ given a stern talking-to.
And here it's even worse than, say, for Python,
since almost any way to indent is valid YAML and means <em>something</em>!
But the <em>structure</em> needs to be just right for the consumer to accept it …​</td></tr></tbody></table></div></article><section class="article labels"><a class=tag href=/today-i-learned/tags/tool/>Tool</a><a class=tag href=/today-i-learned/tags/json-schema/>JSON Schema</a><a class=tag href=/today-i-learned/tags/intellij-idea/>Intellij IDEA</a><a class=tag href=/today-i-learned/tags/programming/>Programming</a></section><section class="article tweet">Comment & Share on 
    <a href=https://twitter.com/OmegaPolice/status/1271198064951386118>Twitter&nbsp;<span class="iconfont icon-twitter"></span></a></section></div><div class="article bottom"><section class="article navigation"><p><a class=link href=/today-i-learned/posts/2020-06-15-logging-in-go-with-zap/><span class="iconfont icon-article"></span>Logging in Go With Zap</a></p><p><a class=link href=/today-i-learned/posts/2020-06-10-targeted-docker-inspection/><span class="iconfont icon-article"></span>Targeted Docker Inspection</a></p></section></div></section><section id=footer><div class=footer-wrap><p class=copyright>© 2020 Raphael Reitzig<br>This work is licensed under a
<a rel=license href=http://creativecommons.org/licenses/by/4.0/>Creative Commons Attribution 4.0 International License
</a>.<br><a rel=license href=http://creativecommons.org/licenses/by/4.0/><img alt="Creative Commons License" style=border-width:0 src=cc-by-80x15.png></a></p><p class=powerby><span>Powered&nbsp;by&nbsp;</span><a href=https://gohugo.io target=_blank>Hugo</a><span>&nbsp;&&nbsp;</span><a href=https://themes.gohugo.io/hugo-notepadium/ target=_blank>Notepadium</a></p></div></section><script src=/today-i-learned/js/hljs.min.0799348a91dce12c6be4a73f943cfe78f181f4e6f6ec35c4af0fca1de377879f77cfab03c30f03a174d675737b5a9314.js integrity=sha384-B5k0ipHc4Sxr5Kc/lDz+ePGB9Ob27DXErw/KHeN3h593z6sDww8DoXTWdXN7WpMU></script><script>hljs.initHighlightingOnLoad();</script></body></html>